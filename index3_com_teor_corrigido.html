<!DOCTYPE html>

<html lang="pt-BR">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Análise de Combustível – Rede Benedetti</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&amp;display=swap" rel="stylesheet"/>
<style>
    * { margin:0; padding:0; box-sizing:border-box; }
    body { background:#0f1115; color:#e5e5e5; font-family:'Inter', sans-serif; padding:1rem; }
    .container { max-width:600px; margin:auto; background:#1f2937; padding:1.5rem; border-radius:12px; box-shadow:0 4px 12px rgba(0,0,0,0.6); }
    .header { display:flex; align-items:center; margin-bottom:1.5rem; }
    .logo { width:48px; height:48px; background:#FFD700; border-radius:50%; display:flex; align-items:center; justify-content:center; font-size:1.8rem; font-weight:bold; color:#1f2937; margin-right:0.75rem; }
    .header h1 { font-size:1.4rem; color:#FFD700; }
    .field { margin-bottom:1rem; }
    .field label { display:block; margin-bottom:0.25rem; color:#cbd5e1; font-size:0.9rem; }
    .field input, .field select { width:100%; padding:0.5rem; border:none; border-radius:6px; background:#374151; color:#e5e5e5; font-size:1rem; }
    button { width:100%; padding:0.75rem; background:#10B981; border:none; border-radius:6px; color:#fff; font-weight:600; font-size:1rem; cursor:pointer; transition:background 0.2s; }
    button:hover { background:#0fa76b; }
    .result { display:none; margin-top:1.5rem; background:#111827; padding:1rem; border-radius:8px; }
    .status { display:inline-block; padding:0.25rem 0.75rem; border-radius:4px; font-weight:600; margin-bottom:0.75rem; }
    .ok { background:#10B981; }
    .fail { background:#E53E3E; }
    .divider { height:1px; background:#374151; margin:1rem 0; }
    .section-title { font-size:1.1rem; margin-bottom:0.5rem; color:#fff; }
    .item { margin:0.3rem 0; font-size:0.95rem; }
  </style>
</head>
<body>
<div class="container">
<div class="header">
<div class="logo">B</div>
<h1>REDE BENEDETTI</h1>
</div>
<!-- Campos Gerais -->
<div class="field"><label>Nota Fiscal</label><input id="nf" placeholder="Nº da nota fiscal"/></div>
<div class="field"><label>Amostra</label><input id="amostra" placeholder="Identificação da amostra"/></div>
<div class="field"><label>Fornecedor</label><input id="fornecedor" placeholder="Nome do fornecedor"/></div>
<div class="field"><label>Litragem (L)</label><input id="litros" placeholder="Litros" step="0.1" type="number"/></div>
<div class="field"><label>Motorista</label><input id="motorista" placeholder="Nome do motorista"/></div>
<div class="field"><label>Posto / Local</label><input id="posto" placeholder="Nome do posto ou local"/></div>
<div class="field"><label>Responsável</label><input id="responsavel" placeholder="Responsável pelo recebimento"/></div>
<!-- Tipo de combustível -->
<div class="field"><label>Tipo de Combustível</label>
<select id="tipo">
<option value="">-- selecione --</option>
<option value="gasolina">Gasolina</option>
<option value="etanol">Etanol</option>
<option value="diesel">Diesel</option>
</select>
</div>
<!-- Campos adicionais -->
<div class="field" id="field-percent" style="display:none;"><label>% Etanol (Gasolina)</label><input id="percent" max="100" min="0" step="0.1" type="number" value="27"/></div>
<div class="field" id="field-ph" style="display:none;"><label>pH (Etanol)</label><input id="ph" max="14" min="0" step="0.1" type="number"/></div>
<!-- Medidas -->
<div class="field"><label>Temperatura (°C)</label><input id="temp" max="40" min="15" step="0.5" type="number"/></div>
<div class="field"><label>Densidade (g/cm³)</label><input id="dens" step="0.0001" type="number"/></div>
<button id="btnCalcular">Calcular</button>
<!-- Resultado -->
<div class="result" id="resultado">
<div class="status" id="status"></div>
<div class="divider"></div>
<div><div class="section-title">Dados Informados</div><div id="dadosInfo"></div></div>
<div class="divider"></div>
<div><div class="section-title">Referência ANP</div><div id="dadosRef"></div></div>
</div>
</div>
<script>
    // Show/hide dynamic fields
    document.getElementById('tipo').addEventListener('change', function() {
      const t = this.value;
      document.getElementById('field-percent').style.display = t === 'gasolina' ? 'block' : 'none';
      document.getElementById('field-ph').style.display = t === 'etanol' ? 'block' : 'none';
      document.getElementById('resultado').style.display = 'none';
    });
    // ANP density tables
    const densRef = {
      gasolina: {15:{min:0.7241,max:0.7638},15.5:{min:0.7237,max:0.7635},16:{min:0.7233,max:0.7631},16.5:{min:0.7229,max:0.7627},17:{min:0.7225,max:0.7623},17.5:{min:0.7221,max:0.7619},18:{min:0.7217,max:0.7615},18.5:{min:0.7212,max:0.7612},19:{min:0.7208,max:0.7608},19.5:{min:0.7204,max:0.7604},20:{min:0.7200,max:0.7600},20.5:{min:0.7196,max:0.7596},21:{min:0.7192,max:0.7592},21.5:{min:0.7188,max:0.7589},22:{min:0.7183,max:0.7585},22.5:{min:0.7179,max:0.7581},23:{min:0.7175,max:0.7577},23.5:{min:0.7171,max:0.7573},24:{min:0.7167,max:0.7569},24.5:{min:0.7163,max:0.7565},25:{min:0.7159,max:0.7562},25.5:{min:0.7154,max:0.7558},26:{min:0.7150,max:0.7554},26.5:{min:0.7146,max:0.7550},27:{min:0.7142,max:0.7546},27.5:{min:0.7138,max:0.7543},28:{min:0.7134,max:0.7539},28.5:{min:0.7130,max:0.7535},29:{min:0.7125,max:0.7527},29.5:{min:0.7121,max:0.7523},30:{min:0.7117,max:0.7523},30.5:{min:0.7113,max:0.7519},31:{min:0.7109,max:0.7516},31.5:{min:0.7105,max:0.7512},32:{min:0.7100,max:0.7508},32.5:{min:0.7096,max:0.7504},33:{min:0.7092,max:0.7500},33.5:{min:0.7088,max:0.7497},34:{min:0.7084,max:0.7493},34.5:{min:0.7080,max:0.7489},35:{min:0.7075,max:0.7480},35.5:{min:0.7071,max:0.7477},36:{min:0.7067,max:0.7473},36.5:{min:0.7063,max:0.7468},37:{min:0.7059,max:0.7464},37.5:{min:0.7055,max:0.7460},38:{min:0.7051,max:0.7458},38.5:{min:0.7046,max:0.7455},39:{min:0.7042,max:0.7450},39.5:{min:0.7038,max:0.7446},40:{min:0.7034,max:0.7446}},
      etanol: {15:{min:0.8117,max:0.8150},15.5:{min:0.8113,max:0.8147},16:{min:0.8110,max:0.8143},16.5:{min:0.8105,max:0.8138},17:{min:0.8100,max:0.8135},17.5:{min:0.8095,max:0.8130},18:{min:0.8092,max:0.8125},18.5:{min:0.8088,max:0.8122},19:{min:0.8085,max:0.8118},19.5:{min:0.8080,max:0.8113},20:{min:0.8075,max:0.8110},20.5:{min:0.8070,max:0.8105},21:{min:0.8067,max:0.8100},21.5:{min:0.8062,max:0.8097},22:{min:0.8058,max:0.8092},22.5:{min:0.8055,max:0.8087},23:{min:0.8050,max:0.8083},23.5:{min:0.8045,max:0.8080},24:{min:0.8042,max:0.8075},24.5:{min:0.8038,max:0.8070},25:{min:0.8033,max:0.8067},25.5:{min:0.8030,max:0.8063},26:{min:0.8025,max:0.8058},26.5:{min:0.8020,max:0.8055},27:{min:0.8015,max:0.8050},27.5:{min:0.8012,max:0.8045},28:{min:0.8007,max:0.8040},28.5:{min:0.8005,max:0.8037},29:{min:0.8000,max:0.8033},29.5:{min:0.7995,max:0.8028},30:{min:0.7990,max:0.8023},30.5:{min:0.7987,max:0.8020},31:{min:0.7982,max:0.8015},31.5:{min:0.7977,max:0.8010},32:{min:0.7972,max:0.8007},32.5:{min:0.7968,max:0.8003},33:{min:0.7965,max:0.7998},33.5:{min:0.7960,max:0.7993},34:{min:0.7955,max:0.7988},34.5:{min:0.7952,max:0.7985},35:{min:0.7947,max:0.7980},35.5:{min:0.7943,max:0.7975},36:{min:0.7940,max:0.7973},36.5:{min:0.7935,max:0.7968},37:{min:0.7930,max:0.7963},37.5:{min:0.7925,max:0.7958},38:{min:0.7920,max:0.7950},38.5:{min:0.7917,max:0.7945},39:{min:0.7913,max:0.7940},39.5:{min:0.7908,max:0.7937},40:{min:0.7905,max:0.7937}},
      diesel: {15:{min:0.8234,max:0.8832},15.5:{min:0.8231,max:0.8827},16:{min:0.8227,max:0.8826},16.5:{min:0.8224,max:0.8823},17:{min:0.8221,max:0.8819},17.5:{min:0.8217,max:0.8813},18:{min:0.8214,max:0.8810},18.5:{min:0.8210,max:0.8807},19:{min:0.8207,max:0.8804},19.5:{min:0.8204,max:0.8800},20:{min:0.8200,max:0.8797},20.5:{min:0.8197,max:0.8794},21:{min:0.8193,max:0.8790},21.5:{min:0.8188,max:0.8785},22:{min:0.8183,max:0.8781},22.5:{min:0.8176,max:0.8778},23:{min:0.8173,max:0.8775},23.5:{min:0.8169,max:0.8771},24:{min:0.8166,max:0.8768},24.5:{min:0.8163,max:0.8765},25:{min:0.8160,max:0.8762},25.5:{min:0.8157,max:0.8759},26:{min:0.8153,max:0.8756},26.5:{min:0.8149,max:0.8753},27:{min:0.8145,max:0.8749},27.5:{min:0.8141,max:0.8746},28:{min:0.8138,max:0.8743},28.5:{min:0.8134,max:0.8739},29:{min:0.8130,max:0.8736},29.5:{min:0.8127,max:0.8733},30:{min:0.8123,max:0.8730},30.5:{min:0.8119,max:0.8727},31:{min:0.8116,max:0.8724},31.5:{min:0.8112,max:0.8721},32:{min:0.8108,max:0.8718},32.5:{min:0.8105,max:0.8715},33:{min:0.8101,max:0.8712},33.5:{min:0.8097,max:0.8709},34:{min:0.8093,max:0.8706},34.5:{min:0.8090,max:0.8703},35:{min:0.8086,max:0.8699},35.5:{min:0.8082,max:0.8696},36:{min:0.8078,max:0.8693},36.5:{min:0.8075,max:0.8690},37:{min:0.8071,max:0.8687},37.5:{min:0.8067,max:0.8684},38:{min:0.8064,max:0.8681},38.5:{min:0.8060,max:0.8678},39:{min:0.8056,max:0.8675},39.5:{min:0.8053,max:0.8672},40:{min:0.8049,max:0.8669}}
    };
    // Cálculo
    document.getElementById('btnCalcular').addEventListener('click',()=>{
      const tipo=document.getElementById('tipo').value;
      const temp=parseFloat(document.getElementById('temp').value);
      const dens=parseFloat(document.getElementById('dens').value);
      if(!tipo||isNaN(temp)||isNaN(dens)) return alert('Preencha todos os campos!');
      const ref=densRef[tipo][temp];
      if(!ref) return alert(`Sem referência ANP para ${temp}°C.`);
      const ok=dens>=ref.min&&dens<=ref.max;
      let teor='–';
      if(tipo==='etanol'){
        const frac=(dens-ref.min)/(ref.max-ref.min);
        teor=(92.7+frac*(95-92.7)).toFixed(2)+' % m/m';
      }
      // Exibir Resultados
      const statusEl=document.getElementById('status');
      statusEl.textContent=ok?'✔ CONFORME':'✖ FORA DA FAIXA';
      statusEl.className='status '+(ok?'ok':'fail');
      let infoHTML=`
        <div class="item"><strong>Nota Fiscal:</strong> ${document.getElementById('nf').value}</div>
        <div class="item"><strong>Amostra:</strong> ${document.getElementById('amostra').value}</div>
        <div class="item"><strong>Fornecedor:</strong> ${document.getElementById('fornecedor').value}</div>
        <div class="item"><strong>Litragem:</strong> ${document.getElementById('litros').value} L</div>
        <div class="item"><strong>Motorista:</strong> ${document.getElementById('motorista').value}</div>
        <div class="item"><strong>Posto:</strong> ${document.getElementById('posto').value}</div>
        <div class="item"><strong>Responsável:</strong> ${document.getElementById('responsavel').value}</div>
        <div class="item"><strong>Tipo:</strong> ${tipo}</div>
        <div class="item"><strong>Temperatura:</strong> ${temp}°C</div>
        <div class="item"><strong>Densidade:</strong> ${dens} g/cm³</div>
      `;
      if(tipo==='gasolina') infoHTML+=`<div class="item"><strong>% Etanol:</strong> ${document.getElementById('percent').value}%</div>`;
      if(tipo==='etanol') infoHTML+=`<div class="item"><strong>pH:</strong> ${document.getElementById('ph').value}</div><div class="item"><strong>Teor:</strong> ${teor}</div>`;
      document.getElementById('dadosInfo').innerHTML=infoHTML;
      document.getElementById('dadosRef').innerHTML=`
        <div class="item"><strong>Temp Ref:</strong> ${temp}°C</div>
        <div class="item"><strong>Min dens:</strong> ${ref.min.toFixed(4)} g/cm³</div>
        <div class="item"><strong>Max dens:</strong> ${ref.max.toFixed(4)} g/cm³</div>
        <div class="item"><strong>Faixa:</strong> ${ref.min.toFixed(4)} - ${ref.max.toFixed(4)}</div>
        <div class="item"><strong>Data/Hora:</strong> ${new Date().toLocaleString('pt-BR')}</div>
      `;
      document.getElementById('resultado').style.display='block';
    });
  </script>
<script>
function calcularTeorAlcoolico(temp, densidade, tabela) {
    // Normaliza os dados
    let tempStr = parseFloat(temp).toFixed(1);
    let densStr = parseFloat(densidade).toFixed(4);

    // Filtra os dados da tabela
    let filtrado = tabela.filter(l => l.temp === tempStr);
    if (filtrado.length === 0) return null;

    let antes = null, depois = null;
    for (let i = 0; i < filtrado.length - 1; i++) {
        if (densStr >= filtrado[i].densidade && densStr <= filtrado[i+1].densidade) {
            antes = filtrado[i];
            depois = filtrado[i+1];
            break;
        }
    }
    if (!antes || !depois) return null;

    let x0 = parseFloat(antes.densidade), y0 = parseFloat(antes.teor);
    let x1 = parseFloat(depois.densidade), y1 = parseFloat(depois.teor);
    let x = parseFloat(densStr);

    let teorInterpolado = y0 + ((y1 - y0) / (x1 - x0)) * (x - x0);
    return teorInterpolado.toFixed(2);
}

// Carrega e converte tabela para array
async function carregarTabela(callback) {
    const response = await fetch("tabela alcoolométrica (2).txt");
    const texto = await response.text();
    const linhas = texto.trim().split("\n");
    const tabela = linhas.map(l => {
        const [temp, densidade, teor] = l.trim().split("/");
        return {
            temp: parseFloat(temp).toFixed(1),
            densidade: parseFloat(densidade).toFixed(4),
            teor: parseFloat(teor).toFixed(2)
        };
    });
    callback(tabela);
}
</script></body>
</html>
